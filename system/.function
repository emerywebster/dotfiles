#!/usr/bin/env bash

function df-help () {
  echo "Usage: df-<command>"
  echo
  echo "Commands:"
  echo "   clean            Clean up caches (brew, nvm, gem)"
  echo "   edit             Open dotfiles in IDE ($DOTFILES_IDE) and Git GUI ($DOTFILES_GIT_GUI)"
  echo "   help             This help message"
  echo "   update           Update packages and pkg managers (OS, brew, npm, gem)"
}

function df-edit () {
  sh -c "$DOTFILES_IDE $DOTFILES_DIR"
  sh -c "$DOTFILES_GIT_GUI $DOTFILES_DIR"
}

function df-update () {
  sudo softwareupdate -i -a
  brew update
  brew upgrade
  npm install npm -g
  npm update -g
  gem update --system
  gem update
}

function df-clean () {
  brew cleanup
  gem cleanup
  . "$NVM_DIR/nvm.sh"; nvm cache clear
}


function gh-pages-deploy () {
  directory=_site
  current_branch=$(git rev-parse --abbrev-ref HEAD)
  deploy_branch=gh-pages
  build_command() {
    bundle exec jekyll build
  }

  if [[ "$current_branch" != "main" ]]; then
    echo "\033[0;32mAborting - switch to 'main' branch\033[0m";
  else
    echo -e "\033[0;32mGenerating site...\033[0m"
    build_command

    echo -e "\033[0;32mDeploying $deploy_branch branch...\033[0m"
    cd $directory &&
      git add --all &&
      git commit -m "Deploy updates" &&
      git push origin $branch
    cd ..
  fi
}

# grep alias shortcut
al() {
	 alias | grep -e $1
 }